# 绪论

## 系统设计的背景

近年来，随着家用电器品种越来越多，由此而产生的电磁干扰在对电子设备的正常
使用和可靠性产生影响和危害的同时，也对人们的身体健康造成了直接影响。因此
世界各国及有关国际组织建立了电磁兼容实验室，用来检测电子设备的电磁兼容性
。青岛青智仪器有限公司生产的 ZW1402 电流表就用于电磁兼容实验室，它具有一
定的通信功能，支持 RS232 [@fanyz2002] 或 RS485 通信，可以通过编写相应的
软件和它通信，使其实现自动化测量 [@zhaojiong2002] 和数据处理。电磁兼容性
的测量需要采集大量的数据，并且要记录和处理数据，但是目前没有现成的方案，
因此本次的设计内容就是对 ZW1402 进行软件编程，实现自动化测量及数据处理。
为了实现这些功能，并且有一个友好的用户界面，所有的设计内容都是基于
LabWindows/CVI 虚拟仪器软件开发软件。

在实际设计过程中，将 ZW1402 仪表通过串口 [@xieruihe2003; @fanghao2007;
@axelson2001; @elleithy2006] 与计算机相连，根据仪表的通信规约，利用
LabWindows/CVI 开发工具上设计函数面板及各个控件，交互地进行 C
语言编程，实现对串口进行读或写操作，经过编译、链接生成可执行的应用程序，
使得用户可以通过点击相应的控件实现对仪器的相应操作，从而可以方便地控制仪
器的测量、数据记录及处理。

## 系统设计的目的

要测量电子设备的电磁兼容性，有一种方法是量度电源线上的传导干扰，可以通过
测量电源线上的电流得到。为了得到一系列数据用于分析、研究，需要进行长时间
自动化无人监守的测量，并且需要对测量结果进行记录和处理。

由于目前没有现成可用的方案，因此需要设计一个自动化测量系统，可以测量并采
集大量数据，并且能够加以处理，用来分析测量对象的电磁兼容性。打算使用虚拟
仪器开发工具 LabWindows/CVI 进行开发，实现对仪表进行控制。

## 系统设计的内容

本课题“青智 ZW1402 仪表数据通信程序设计”是设计一个可以自动化测量及数据处
理的仪表通信系统。可以运用 LabWindows/CVI 软件开发工具设计控制面板，根据
LabWindows/CVI 提供的函数库，对各个控件编写相应的 C 程序，使其实现相应的
功能。使用设计好的控制界面对仪表进行通信，召测数据、记录数据、设置参数和
画图表。需要完成的内容包括：

1.  了解 ZW1402 仪表的使用方法及其通讯规约。
2.  软件开发工具 LabWindows/CVI 的掌握及熟练应用。
3.  串口通信原理的了解。
4.  利用 LabWindows/CVI 开发工具进行程序设计，与仪表进行通信，实现仪表控
    制和数据采集。
5.  实现数据单次记录和循环记录。
6.  实现数据的记录。
7.  对所记录的数据进行图像分析。

```c
```
